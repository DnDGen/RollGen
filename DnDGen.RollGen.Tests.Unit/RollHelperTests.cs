using NUnit.Framework;

namespace DnDGen.RollGen.Tests.Unit
{
    [TestFixture]
    public class RollHelperTests
    {
        [TestCase(-2, -2, "-2")]
        [TestCase(-2, -1, "1d2-3")]
        [TestCase(-2, 0, "1d3-3")]
        [TestCase(-2, 2, "2d3-4")]
        [TestCase(-2, 3, "1d6-3")]
        [TestCase(-1, -1, "-1")]
        [TestCase(-1, 0, "1d2-2")]
        [TestCase(-1, 1, "1d3-2")]
        [TestCase(-1, 3, "2d3-3")]
        [TestCase(-1, 4, "1d6-2")]
        [TestCase(0, 0, "0")]
        [TestCase(0, 1, "1d2-1")]
        [TestCase(0, 2, "1d3-1")]
        [TestCase(0, 4, "2d3-2")]
        [TestCase(0, 5, "1d6-1")]
        [TestCase(1, 1, "1")]
        [TestCase(1, 2, "1d2")]
        [TestCase(1, 3, "1d3")]
        [TestCase(1, 4, "1d4")]
        [TestCase(1, 5, "2d3-1")]
        [TestCase(1, 6, "1d6")]
        [TestCase(1, 7, "2d4-1")]
        [TestCase(1, 8, "1d8")]
        [TestCase(1, 9, "4d3-3")]
        [TestCase(1, 10, "1d10")]
        [TestCase(1, 11, "2d6-1")]
        [TestCase(1, 12, "1d12")]
        [TestCase(1, 20, "1d20")]
        [TestCase(1, 100, "1d100")]
        [TestCase(2, 2, "2")]
        [TestCase(2, 3, "1d2+1")]
        [TestCase(2, 4, "1d3+1")]
        [TestCase(2, 5, "1d4+1")]
        [TestCase(2, 6, "2d3")]
        [TestCase(2, 7, "1d6+1")]
        [TestCase(2, 8, "2d4")]
        [TestCase(2, 10, "4d3-2")]
        [TestCase(2, 12, "2d6")]
        [TestCase(2, 13, "1d12+1")]
        [TestCase(2, 15, "1d12+1d3")]
        [TestCase(2, 20, "2d10")]
        [TestCase(2, 24, "2d12")]
        [TestCase(2, 40, "2d20")]
        [TestCase(2, 200, "2d100")]
        [TestCase(3, 3, "3")]
        [TestCase(3, 4, "1d2+2")]
        [TestCase(3, 5, "1d3+2")]
        [TestCase(3, 6, "1d4+2")]
        [TestCase(3, 8, "1d6+2")]
        [TestCase(3, 9, "2d4+1")]
        [TestCase(3, 10, "1d8+2")]
        [TestCase(3, 12, "1d10+2")]
        [TestCase(3, 13, "2d6+1")]
        [TestCase(3, 18, "3d6")]
        [TestCase(3, 20, "1d12+2d4")]
        [TestCase(3, 24, "3d8")]
        [TestCase(3, 28, "5d6-2")]
        [TestCase(3, 30, "3d10")]
        [TestCase(3, 36, "3d12")]
        [TestCase(4, 4, "4")]
        [TestCase(4, 5, "1d2+3")]
        [TestCase(4, 6, "1d3+3")]
        [TestCase(4, 7, "1d4+3")]
        [TestCase(4, 8, "2d3+2")]
        [TestCase(4, 9, "1d6+3")]
        [TestCase(4, 10, "2d4+2")]
        [TestCase(4, 12, "4d3")]
        [TestCase(4, 16, "4d4")]
        [TestCase(4, 24, "4d6")]
        [TestCase(4, 32, "4d8")]
        [TestCase(4, 40, "4d10")]
        [TestCase(4, 48, "4d12")]
        [TestCase(5, 5, "5")]
        [TestCase(5, 8, "1d4+4")]
        [TestCase(5, 9, "2d3+3")]
        [TestCase(5, 10, "1d6+4")]
        [TestCase(5, 12, "1d8+4")]
        [TestCase(5, 13, "4d3+1")]
        [TestCase(5, 14, "1d10+4")]
        [TestCase(5, 16, "1d12+4")]
        [TestCase(5, 18, "1d12+1d3+3")]
        [TestCase(5, 20, "3d6+2")]
        [TestCase(5, 30, "5d6")]
        [TestCase(5, 40, "5d8")]
        [TestCase(5, 50, "5d10")]
        [TestCase(5, 60, "5d12")]
        [TestCase(6, 6, "6")]
        [TestCase(6, 7, "1d2+5")]
        [TestCase(6, 8, "1d3+5")]
        [TestCase(6, 9, "1d4+5")]
        [TestCase(6, 10, "2d3+4")]
        [TestCase(6, 11, "1d6+5")]
        [TestCase(6, 13, "1d8+5")]
        [TestCase(6, 15, "1d10+5")]
        [TestCase(6, 18, "4d4+2")]
        [TestCase(6, 20, "2d8+4")]
        [TestCase(6, 24, "2d10+4")]
        [TestCase(6, 30, "8d4-2")]
        [TestCase(6, 36, "6d6")]
        [TestCase(6, 45, "13d4-7")]
        [TestCase(7, 7, "7")]
        [TestCase(7, 10, "1d4+6")]
        [TestCase(7, 11, "2d3+5")]
        [TestCase(7, 12, "1d6+6")]
        [TestCase(7, 16, "1d10+6")]
        [TestCase(7, 18, "1d12+6")]
        [TestCase(7, 30, "1d20+2d3+4")]
        [TestCase(7, 42, "5d8+2")]
        [TestCase(7, 50, "2d20+1d6+4")]
        [TestCase(8, 8, "8")]
        [TestCase(8, 9, "1d2+7")]
        [TestCase(8, 18, "2d6+6")]
        [TestCase(8, 16, "4d3+4")]
        [TestCase(9, 9, "9")]
        [TestCase(9, 14, "1d6+8")]
        [TestCase(9, 16, "1d8+8")]
        [TestCase(9, 30, "3d8+6")]
        [TestCase(10, 10, "10")]
        [TestCase(10, 11, "1d2+9")]
        [TestCase(10, 20, "2d6+8")]
        [TestCase(10, 24, "2d8+8")]
        [TestCase(10, 40, "6d6+4")]
        [TestCase(10, 50, "8d6+2")]
        [TestCase(10, 60, "10d6")]
        [TestCase(10, 80, "10d8")]
        [TestCase(10, 100, "10d10")]
        [TestCase(10, 120, "10d12")]
        [TestCase(11, 11, "11")]
        [TestCase(11, 20, "1d10+10")]
        [TestCase(11, 40, "1d20+2d6+8")]
        [TestCase(12, 12, "12")]
        [TestCase(12, 13, "1d2+11")]
        [TestCase(12, 22, "2d6+10")]
        [TestCase(12, 24, "4d4+8")]
        [TestCase(12, 30, "2d10+10")]
        [TestCase(13, 13, "13")]
        [TestCase(14, 14, "14")]
        [TestCase(14, 15, "1d2+13")]
        [TestCase(15, 15, "15")]
        [TestCase(15, 30, "3d6+12")]
        [TestCase(15, 50, "5d8+10")]
        [TestCase(15, 150, "15d10")]
        [TestCase(16, 16, "16")]
        [TestCase(16, 17, "1d2+15")]
        [TestCase(17, 17, "17")]
        [TestCase(18, 18, "18")]
        [TestCase(18, 19, "1d2+17")]
        [TestCase(18, 72, "6d10+12")]
        [TestCase(19, 19, "19")]
        [TestCase(20, 20, "20")]
        [TestCase(20, 50, "6d6+14")]
        [TestCase(20, 80, "12d6+8")]
        [TestCase(20, 150, "26d6-6")]
        [TestCase(20, 160, "20d8")]
        [TestCase(20, 200, "20d10")]
        [TestCase(20, 240, "20d12")]
        [TestCase(21, 30, "1d10+20")]
        [TestCase(21, 40, "1d20+20")]
        [TestCase(30, 50, "4d6+26")]
        [TestCase(30, 60, "6d6+24")]
        [TestCase(30, 100, "10d8+20")]
        [TestCase(30, 120, "10d10+20")]
        [TestCase(30, 180, "30d6")]
        [TestCase(30, 240, "30d8")]
        [TestCase(30, 300, "30d10")]
        [TestCase(30, 360, "30d12")]
        [TestCase(40, 160, "24d6+16")]
        [TestCase(40, 240, "40d6")]
        [TestCase(40, 320, "40d8")]
        [TestCase(40, 400, "40d10")]
        [TestCase(40, 480, "40d12")]
        [TestCase(50, 200, "30d6+20")]
        [TestCase(50, 300, "50d6")]
        [TestCase(45, 150, "15d8+30")]
        [TestCase(60, 240, "20d10+40")]
        [TestCase(60, 360, "60d6")]
        [TestCase(70, 160, "10d10+60")]
        [TestCase(70, 420, "50d8+20")]
        [TestCase(100, 400, "60d6+40")]
        [TestCase(100, 600, "100d6")]
        [TestCase(100, 800, "100d8")]
        [TestCase(100, 1000, "100d10")]
        [TestCase(100, 1200, "100d12")]
        [TestCase(200, 800, "6d100+2d4+192")]
        [TestCase(200, 1200, "10d100+2d6+188")]
        [TestCase(200, 1600, "200d8")]
        [TestCase(200, 2000, "200d10")]
        [TestCase(300, 1200, "300d4")]
        [TestCase(300, 1800, "300d6")]
        [TestCase(300, 2400, "300d8")]
        [TestCase(300, 3000, "300d10")]
        [TestCase(300, 3600, "300d12")]
        [TestCase(400, 1600, "400d4")]
        [TestCase(400, 2400, "400d6")]
        [TestCase(400, 3200, "400d8")]
        [TestCase(400, 4000, "400d10")]
        [TestCase(400, 4800, "400d12")]
        [TestCase(500, 2000, "500d4")]
        [TestCase(500, 3000, "500d6")]
        [TestCase(600, 2400, "600d4")]
        [TestCase(600, 3600, "600d6")]
        [TestCase(700, 4200, "700d6")]
        [TestCase(1000, 4000, "1000d4")]
        [TestCase(1000, 6000, "1000d6")]
        [TestCase(1000, 8000, "1000d8")]
        [TestCase(1000, 10000, "1000d10")]
        [TestCase(1000, 12000, "1000d12")]
        [TestCase(2000, 8000, "2000d4")]
        [TestCase(2000, 12000, "2000d6")]
        [TestCase(2000, 16000, "2000d8")]
        [TestCase(2000, 20000, "181d100+4d20+1d6+1814")]
        [TestCase(3000, 12000, "90d100+4d20+2d8+2904")]
        [TestCase(3000, 18000, "151d100+2d20+1d12+1d3+2845")]
        [TestCase(3000, 24000, "211d100+5d20+1d10+1d8+2782")]
        [TestCase(3000, 30000, "271d100+9d20+2720")]
        [TestCase(3000, 36000, "331d100+11d20+2d12+2656")]
        [TestCase(4000, 16000, "331d100+11d20+2d12+2656")]
        [TestCase(4000, 24000, "331d100+11d20+2d12+2656")]
        [TestCase(4000, 32000, "281d100+9d20+2d6+3708")]
        [TestCase(4000, 40000, "281d100+9d20+2d6+3708")]
        [TestCase(4000, 48000, "441d100+17d20+2d10+3540")]
        [TestCase(5000, 20000, "441d100+17d20+2d10+3540")]
        [TestCase(5000, 30000, "441d100+17d20+2d10+3540")]
        [TestCase(6000, 24000, "441d100+17d20+2d10+3540")]
        [TestCase(6000, 36000, "441d100+17d20+2d10+3540")]
        [TestCase(7000, 42000, "441d100+17d20+2d10+3540")]
        [TestCase(10000, 40000, "301d100+10d20+1d12+9688")]
        [TestCase(10000, 60000, "501d100+21d20+1d3+9477")]
        [TestCase(10000, 80000, "70d100+3d20+1d12+1d3+925")]
        [TestCase(10000, 100000, "901d100+41d20+2d12+9056")]
        [TestCase(10000, 120000, "1101d100+50d20+4d12+1d8+8844")]
        [TestCase(20000, 80000, "1101d100+50d20+4d12+1d8+8844")]
        [TestCase(20000, 120000, "1001d100+46d20+3d10+18950")]
        [TestCase(20000, 160000, "1001d100+46d20+3d10+18950")]
        [TestCase(20000, 200000, "1001d100+46d20+3d10+18950")]
        [TestCase(30000, 120000, "90d100+4d20+2d8+2904")]
        [TestCase(30000, 180000, "151d100+2d20+1d12+1d3+2845")]
        [TestCase(30000, 240000, "151d100+2d20+1d12+1d3+2845")]
        [TestCase(30000, 300000, "151d100+2d20+1d12+1d3+2845")]
        [TestCase(30000, 360000, "151d100+2d20+1d12+1d3+2845")]
        [TestCase(40000, 160000, "151d100+2d20+1d12+1d3+2845")]
        [TestCase(40000, 240000, "151d100+2d20+1d12+1d3+2845")]
        [TestCase(40000, 320000, "151d100+2d20+1d12+1d3+2845")]
        [TestCase(40000, 400000, "151d100+2d20+1d12+1d3+2845")]
        [TestCase(40000, 480000, "151d100+2d20+1d12+1d3+2845")]
        [TestCase(50000, 200000, "151d100+2d20+1d12+1d3+2845")]
        [TestCase(50000, 300000, "151d100+2d20+1d12+1d3+2845")]
        [TestCase(60000, 240000, "151d100+2d20+1d12+1d3+2845")]
        [TestCase(60000, 360000, "151d100+2d20+1d12+1d3+2845")]
        [TestCase(70000, 420000, "151d100+2d20+1d12+1d3+2845")]
        public void Roll(int lower, int upper, string expectedRoll)
        {
            var roll = RollHelper.GetRoll(lower, upper);
            Assert.That(roll, Is.EqualTo(expectedRoll));
        }

        [TestCase(1, 2, 2, "1")]
        [TestCase(6, 7, 9, "1d3")]
        [TestCase(6, 8, 10, "1d3+1")]
        [TestCase(6, 10, 18, "1d8+1d2+2")]
        [TestCase(9, 14, 27, "1d12+1d3+3")]
        [TestCase(9, 15, 27, "1d12+1d2+4")]
        [TestCase(12, 19, 36, "1d12+2d4+4")]
        [TestCase(15, 22, 45, "1d20+2d3+4")]
        public void Roll(int baseAmount, int lower, int upper, string expectedRoll)
        {
            var roll = RollHelper.GetRoll(baseAmount, lower, upper);
            Assert.That(roll, Is.EqualTo(expectedRoll));
        }

        [TestCase(0, 1)]
        [TestCase(0, 2)]
        [TestCase(0, 4)]
        [TestCase(0, 5)]
        [TestCase(1, 1)]
        [TestCase(1, 2)]
        [TestCase(1, 3)]
        [TestCase(1, 4)]
        [TestCase(1, 5)]
        [TestCase(1, 6)]
        [TestCase(1, 7)]
        [TestCase(1, 8)]
        [TestCase(1, 9)]
        [TestCase(1, 10)]
        [TestCase(1, 11)]
        [TestCase(1, 12)]
        [TestCase(2, 2)]
        [TestCase(2, 3)]
        [TestCase(2, 4)]
        [TestCase(2, 5)]
        [TestCase(2, 6)]
        [TestCase(2, 7)]
        [TestCase(2, 8)]
        [TestCase(2, 10)]
        [TestCase(2, 12)]
        [TestCase(2, 15)]
        [TestCase(2, 13)]
        [TestCase(2, 20)]
        [TestCase(3, 3)]
        [TestCase(3, 4)]
        [TestCase(3, 5)]
        [TestCase(3, 6)]
        [TestCase(3, 8)]
        [TestCase(3, 9)]
        [TestCase(3, 10)]
        [TestCase(3, 12)]
        [TestCase(3, 13)]
        [TestCase(3, 18)]
        [TestCase(3, 20)]
        [TestCase(3, 28)]
        [TestCase(4, 4)]
        [TestCase(4, 5)]
        [TestCase(4, 6)]
        [TestCase(4, 7)]
        [TestCase(4, 8)]
        [TestCase(4, 9)]
        [TestCase(4, 10)]
        [TestCase(4, 12)]
        [TestCase(4, 16)]
        [TestCase(4, 32)]
        [TestCase(5, 5)]
        [TestCase(5, 8)]
        [TestCase(5, 9)]
        [TestCase(5, 10)]
        [TestCase(5, 12)]
        [TestCase(5, 13)]
        [TestCase(5, 14)]
        [TestCase(5, 16)]
        [TestCase(5, 18)]
        [TestCase(5, 20)]
        [TestCase(5, 30)]
        [TestCase(5, 50)]
        [TestCase(6, 6)]
        [TestCase(6, 7)]
        [TestCase(6, 8)]
        [TestCase(6, 9)]
        [TestCase(6, 10)]
        [TestCase(6, 11)]
        [TestCase(6, 13)]
        [TestCase(6, 15)]
        [TestCase(6, 18)]
        [TestCase(6, 20)]
        [TestCase(6, 30)]
        [TestCase(6, 45)]
        [TestCase(7, 7)]
        [TestCase(7, 10)]
        [TestCase(7, 11)]
        [TestCase(7, 12)]
        [TestCase(7, 16)]
        [TestCase(7, 18)]
        [TestCase(7, 30)]
        [TestCase(7, 50)]
        [TestCase(8, 8)]
        [TestCase(8, 9)]
        [TestCase(8, 18)]
        [TestCase(8, 16)]
        [TestCase(9, 9)]
        [TestCase(9, 14)]
        [TestCase(9, 16)]
        [TestCase(9, 30)]
        [TestCase(10, 10)]
        [TestCase(10, 11)]
        [TestCase(10, 20)]
        [TestCase(10, 24)]
        [TestCase(10, 40)]
        [TestCase(10, 50)]
        [TestCase(10, 60)]
        [TestCase(10, 80)]
        [TestCase(10, 100)]
        [TestCase(11, 11)]
        [TestCase(11, 20)]
        [TestCase(11, 40)]
        [TestCase(12, 12)]
        [TestCase(12, 13)]
        [TestCase(12, 22)]
        [TestCase(12, 24)]
        [TestCase(12, 30)]
        [TestCase(13, 13)]
        [TestCase(14, 14)]
        [TestCase(14, 15)]
        [TestCase(15, 15)]
        [TestCase(15, 30)]
        [TestCase(15, 50)]
        [TestCase(15, 150)]
        [TestCase(16, 16)]
        [TestCase(16, 17)]
        [TestCase(17, 17)]
        [TestCase(18, 18)]
        [TestCase(18, 19)]
        [TestCase(18, 72)]
        [TestCase(19, 19)]
        [TestCase(20, 20)]
        [TestCase(20, 50)]
        [TestCase(20, 80)]
        [TestCase(20, 150)]
        [TestCase(20, 160)]
        [TestCase(20, 200)]
        [TestCase(21, 30)]
        [TestCase(21, 40)]
        [TestCase(30, 50)]
        [TestCase(30, 60)]
        [TestCase(30, 100)]
        [TestCase(30, 300)]
        [TestCase(40, 400)]
        [TestCase(45, 150)]
        [TestCase(70, 160)]
        [TestCase(100, 400)]
        public void RollCollection(int lower, int upper)
        {
            var rollCollection = RollHelper.GetRollCollection(lower, upper);
            Assert.That(rollCollection.Lower, Is.EqualTo(lower));
            Assert.That(rollCollection.Upper, Is.EqualTo(upper));
            Assert.That(rollCollection.Matches(lower, upper), Is.True);
        }
    }
}
