using NUnit.Framework;

namespace DnDGen.RollGen.Tests.Unit
{
    [TestFixture]
    public class RollHelperTests
    {
        [TestCase(-2, -2, "-2")]
        [TestCase(-2, -1, "1d2-3")]
        [TestCase(-2, 0, "1d3-3")]
        [TestCase(-2, 2, "2d3-4")]
        [TestCase(-2, 3, "1d6-3")]
        [TestCase(-1, -1, "-1")]
        [TestCase(-1, 0, "1d2-2")]
        [TestCase(-1, 1, "1d3-2")]
        [TestCase(-1, 3, "2d3-3")]
        [TestCase(-1, 4, "1d6-2")]
        [TestCase(0, 0, "0")]
        [TestCase(0, 1, "1d2-1")]
        [TestCase(0, 2, "1d3-1")]
        [TestCase(0, 4, "2d3-2")]
        [TestCase(0, 5, "1d6-1")]
        [TestCase(1, 1, "1")]
        [TestCase(1, 2, "1d2")]
        [TestCase(1, 3, "1d3")]
        [TestCase(1, 4, "1d4")]
        [TestCase(1, 5, "2d3-1")]
        [TestCase(1, 6, "1d6")]
        [TestCase(1, 7, "2d4-1")]
        [TestCase(1, 8, "1d8")]
        [TestCase(1, 9, "4d3-3")]
        [TestCase(1, 10, "1d10")]
        [TestCase(1, 11, "2d6-1")]
        [TestCase(1, 12, "1d12")]
        [TestCase(1, 20, "1d20")]
        [TestCase(1, 36, "5d8-4")]
        [TestCase(1, 48, "47d2-46")]
        [TestCase(1, 52, "17d4-16")]
        [TestCase(1, 100, "1d100")]
        [TestCase(1, 103, "34d4-33")]
        [TestCase(2, 2, "2")]
        [TestCase(2, 3, "1d2+1")]
        [TestCase(2, 4, "1d3+1")]
        [TestCase(2, 5, "1d4+1")]
        [TestCase(2, 6, "2d3")]
        [TestCase(2, 7, "1d6+1")]
        [TestCase(2, 8, "2d4")]
        [TestCase(2, 10, "4d3-2")]
        [TestCase(2, 12, "2d6")]
        [TestCase(2, 13, "1d12+1")]
        [TestCase(2, 15, "13d2-11")]
        [TestCase(2, 20, "2d10")]
        [TestCase(2, 24, "2d12")]
        [TestCase(2, 40, "2d20")]
        [TestCase(2, 200, "2d100")]
        [TestCase(3, 3, "3")]
        [TestCase(3, 4, "1d2+2")]
        [TestCase(3, 5, "1d3+2")]
        [TestCase(3, 6, "1d4+2")]
        [TestCase(3, 8, "1d6+2")]
        [TestCase(3, 9, "2d4+1")]
        [TestCase(3, 10, "1d8+2")]
        [TestCase(3, 12, "1d10+2")]
        [TestCase(3, 13, "2d6+1")]
        [TestCase(3, 18, "3d6")]
        [TestCase(3, 20, "17d2-14")]
        [TestCase(3, 24, "3d8")]
        [TestCase(3, 28, "5d6-2")]
        [TestCase(3, 30, "3d10")]
        [TestCase(3, 36, "3d12")]
        [TestCase(4, 4, "4")]
        [TestCase(4, 5, "1d2+3")]
        [TestCase(4, 6, "1d3+3")]
        [TestCase(4, 7, "1d4+3")]
        [TestCase(4, 8, "2d3+2")]
        [TestCase(4, 9, "1d6+3")]
        [TestCase(4, 10, "2d4+2")]
        [TestCase(4, 12, "4d3")]
        [TestCase(4, 16, "4d4")]
        [TestCase(4, 24, "4d6")]
        [TestCase(4, 32, "4d8")]
        [TestCase(4, 40, "4d10")]
        [TestCase(4, 48, "4d12")]
        [TestCase(5, 5, "5")]
        [TestCase(5, 8, "1d4+4")]
        [TestCase(5, 9, "2d3+3")]
        [TestCase(5, 10, "1d6+4")]
        [TestCase(5, 12, "1d8+4")]
        [TestCase(5, 13, "4d3+1")]
        [TestCase(5, 14, "1d10+4")]
        [TestCase(5, 16, "1d12+4")]
        [TestCase(5, 18, "13d2-8")]
        [TestCase(5, 20, "3d6+2")]
        [TestCase(5, 30, "5d6")]
        [TestCase(5, 40, "5d8")]
        [TestCase(5, 50, "5d10")]
        [TestCase(5, 60, "5d12")]
        [TestCase(6, 6, "6")]
        [TestCase(6, 7, "1d2+5")]
        [TestCase(6, 8, "1d3+5")]
        [TestCase(6, 9, "1d4+5")]
        [TestCase(6, 10, "2d3+4")]
        [TestCase(6, 11, "1d6+5")]
        [TestCase(6, 13, "1d8+5")]
        [TestCase(6, 15, "1d10+5")]
        [TestCase(6, 18, "4d4+2")]
        [TestCase(6, 20, "2d8+4")]
        [TestCase(6, 24, "2d10+4")]
        [TestCase(6, 30, "8d4-2")]
        [TestCase(6, 36, "6d6")]
        [TestCase(6, 45, "13d4-7")]
        [TestCase(7, 7, "7")]
        [TestCase(7, 10, "1d4+6")]
        [TestCase(7, 11, "2d3+5")]
        [TestCase(7, 12, "1d6+6")]
        [TestCase(7, 16, "1d10+6")]
        [TestCase(7, 18, "1d12+6")]
        [TestCase(7, 30, "23d2-16")]
        [TestCase(7, 42, "5d8+2")]
        [TestCase(7, 50, "43d2-36")]
        [TestCase(8, 8, "8")]
        [TestCase(8, 9, "1d2+7")]
        [TestCase(8, 18, "2d6+6")]
        [TestCase(8, 16, "4d3+4")]
        [TestCase(9, 9, "9")]
        [TestCase(9, 14, "1d6+8")]
        [TestCase(9, 16, "1d8+8")]
        [TestCase(9, 30, "3d8+6")]
        [TestCase(10, 10, "10")]
        [TestCase(10, 11, "1d2+9")]
        [TestCase(10, 20, "2d6+8")]
        [TestCase(10, 24, "2d8+8")]
        [TestCase(10, 40, "6d6+4")]
        [TestCase(10, 50, "8d6+2")]
        [TestCase(10, 60, "10d6")]
        [TestCase(10, 80, "10d8")]
        [TestCase(10, 100, "10d10")]
        [TestCase(10, 120, "10d12")]
        [TestCase(11, 11, "11")]
        [TestCase(11, 20, "1d10+10")]
        [TestCase(11, 40, "29d2-18")]
        [TestCase(12, 12, "12")]
        [TestCase(12, 13, "1d2+11")]
        [TestCase(12, 22, "2d6+10")]
        [TestCase(12, 24, "4d4+8")]
        [TestCase(12, 30, "2d10+10")]
        [TestCase(13, 13, "13")]
        [TestCase(14, 14, "14")]
        [TestCase(14, 15, "1d2+13")]
        [TestCase(15, 15, "15")]
        [TestCase(15, 30, "3d6+12")]
        [TestCase(15, 50, "5d8+10")]
        [TestCase(15, 150, "15d10")]
        [TestCase(16, 16, "16")]
        [TestCase(16, 17, "1d2+15")]
        [TestCase(17, 17, "17")]
        [TestCase(18, 18, "18")]
        [TestCase(18, 19, "1d2+17")]
        [TestCase(18, 72, "6d10+12")]
        [TestCase(19, 19, "19")]
        [TestCase(20, 20, "20")]
        [TestCase(20, 50, "6d6+14")]
        [TestCase(20, 80, "12d6+8")]
        [TestCase(20, 150, "26d6-6")]
        [TestCase(20, 160, "20d8")]
        [TestCase(20, 200, "20d10")]
        [TestCase(20, 240, "20d12")]
        [TestCase(21, 30, "1d10+20")]
        [TestCase(21, 40, "1d20+20")]
        [TestCase(30, 50, "4d6+26")]
        [TestCase(30, 60, "6d6+24")]
        [TestCase(30, 100, "10d8+20")]
        [TestCase(30, 120, "10d10+20")]
        [TestCase(30, 180, "30d6")]
        [TestCase(30, 240, "30d8")]
        [TestCase(30, 300, "30d10")]
        [TestCase(30, 360, "30d12")]
        [TestCase(40, 160, "24d6+16")]
        [TestCase(40, 240, "40d6")]
        [TestCase(40, 320, "40d8")]
        [TestCase(40, 400, "40d10")]
        [TestCase(40, 480, "40d12")]
        [TestCase(42, 42, "42")]
        [TestCase(42, 96, "6d10+36")]
        [TestCase(42, 600, "62d10-20")]
        [TestCase(42, 783, "39d20+3")]
        [TestCase(42, 1336, "647d3-605")]
        [TestCase(42, 1337, "185d8-143")]
        [TestCase(42, 8245, "8203d2-8161")]
        [TestCase(42, 9266, "4612d3-4570")]
        [TestCase(42, 90210, "910d100+26d4-894")]
        [TestCase(50, 200, "30d6+20")]
        [TestCase(50, 300, "50d6")]
        [TestCase(45, 150, "15d8+30")]
        [TestCase(60, 240, "20d10+40")]
        [TestCase(60, 360, "60d6")]
        [TestCase(70, 160, "10d10+60")]
        [TestCase(70, 420, "50d8+20")]
        [TestCase(96, 96, "96")]
        [TestCase(96, 600, "56d10+40")]
        [TestCase(96, 783, "229d4-133")]
        [TestCase(96, 1336, "248d6-152")]
        [TestCase(96, 1337, "1241d2-1145")]
        [TestCase(96, 8245, "8149d2-8053")]
        [TestCase(96, 9266, "1310d8-1214")]
        [TestCase(96, 90210, "910d100+8d4-822")]
        [TestCase(100, 400, "60d6+40")]
        [TestCase(100, 600, "100d6")]
        [TestCase(100, 800, "100d8")]
        [TestCase(100, 1000, "100d10")]
        [TestCase(100, 1200, "100d12")]
        [TestCase(200, 800, "120d6+80")]
        [TestCase(200, 1200, "200d6")]
        [TestCase(200, 1600, "200d8")]
        [TestCase(200, 2000, "200d10")]
        [TestCase(300, 1200, "100d10+200")]
        [TestCase(300, 1800, "300d6")]
        [TestCase(300, 2400, "300d8")]
        [TestCase(300, 3000, "300d10")]
        [TestCase(300, 3600, "300d12")]
        [TestCase(400, 1600, "240d6+160")]
        [TestCase(400, 2400, "400d6")]
        [TestCase(400, 3200, "400d8")]
        [TestCase(400, 4000, "400d10")]
        [TestCase(400, 4800, "400d12")]
        [TestCase(437, 1204, "767d2-330")]
        [TestCase(500, 2000, "300d6+200")]
        [TestCase(500, 3000, "500d6")]
        [TestCase(600, 600, "600")]
        [TestCase(600, 783, "61d4+539")]
        [TestCase(600, 1336, "368d3+232")]
        [TestCase(600, 1337, "67d12+533")]
        [TestCase(600, 2400, "200d10+400")]
        [TestCase(600, 3600, "600d6")]
        [TestCase(600, 8245, "695d12-95")]
        [TestCase(600, 9266, "1238d8-638")]
        [TestCase(600, 90210, "905d100+3d6-308")]
        [TestCase(700, 4200, "500d8+200")]
        [TestCase(783, 783, "783")]
        [TestCase(783, 1336, "79d8+704")]
        [TestCase(783, 1337, "277d3+506")]
        [TestCase(783, 8245, "1066d8-283")]
        [TestCase(783, 9266, "8483d2-7700")]
        [TestCase(783, 90210, "903d100+6d6-126")]
        [TestCase(1000, 4000, "600d6+400")]
        [TestCase(1000, 6000, "1000d6")]
        [TestCase(1000, 8000, "1000d8")]
        [TestCase(1000, 10_000, "1000d10")]
        [TestCase(1000, 12_000, "1000d12")]
        [TestCase(1336, 1336, "1336")]
        [TestCase(1336, 1337, "1d2+1335")]
        [TestCase(1336, 8245, "987d8+349")]
        [TestCase(1336, 9266, "1586d6-250")]
        [TestCase(1336, 90210, "897d100+71d2+368")]
        [TestCase(1337, 1337, "1337")]
        [TestCase(1337, 8245, "628d12+709")]
        [TestCase(1337, 9266, "881d10+456")]
        [TestCase(1337, 90210, "897d100+10d8+430")]
        [TestCase(2000, 8000, "1200d6+800")]
        [TestCase(2000, 12_000, "2000d6")]
        [TestCase(2000, 16_000, "2000d8")]
        [TestCase(2000, 20_000, "2000d10")]
        [TestCase(2000, 24_000, "2000d12")]
        [TestCase(3000, 12_000, "1000d10+2000")]
        [TestCase(3000, 18_000, "3000d6")]
        [TestCase(3000, 24_000, "3000d8")]
        [TestCase(3000, 30_000, "3000d10")]
        [TestCase(3000, 36_000, "3000d12")]
        [TestCase(4000, 16_000, "2400d6+1600")]
        [TestCase(4000, 24_000, "4000d6")]
        [TestCase(4000, 32_000, "4000d8")]
        [TestCase(4000, 40_000, "4000d10")]
        [TestCase(4000, 48_000, "4000d12")]
        [TestCase(5000, 20_000, "3000d6+2000")]
        [TestCase(5000, 30_000, "5000d6")]
        [TestCase(5000, 40_000, "5000d8")]
        [TestCase(5000, 50_000, "5000d10")]
        [TestCase(5000, 60_000, "5000d12")]
        [TestCase(6000, 24_000, "2000d10+4000")]
        [TestCase(6000, 36_000, "6000d6")]
        [TestCase(6000, 48_000, "6000d8")]
        [TestCase(6000, 60_000, "6000d10")]
        [TestCase(6000, 72_000, "6000d12")]
        [TestCase(7000, 28_000, "3000d8+4000")]
        [TestCase(7000, 42_000, "5000d8+2000")]
        [TestCase(7000, 56_000, "7000d8")]
        [TestCase(7000, 70_000, "7000d10")]
        [TestCase(7000, 84_000, "7000d12")]
        [TestCase(8245, 8245, "8245")]
        [TestCase(8245, 9266, "1021d2+7224")]
        [TestCase(8245, 90210, "827d100+46d3+7372")]
        [TestCase(9266, 9266, "9266")]
        [TestCase(9266, 90210, "817d100+61d2+8388")]
        [TestCase(10_000, 40_000, "6000d6+4000")]
        [TestCase(10_000, 60_000, "10000d6")]
        [TestCase(10_000, 80_000, "10000d8")]
        [TestCase(10_000, 100_000, "10000d10")]
        [TestCase(10_000, 120_000, "10000d12")]
        [TestCase(20_000, 80_000, "606d100+2d4+19392")]
        [TestCase(20_000, 120_000, "1010d100+2d6+18988")]
        [TestCase(20_000, 160_000, "1414d100+2d8+18584")]
        [TestCase(20_000, 200_000, "1818d100+2d10+18180")]
        [TestCase(20_000, 240_000, "2222d100+2d12+17776")]
        [TestCase(30_000, 120_000, "10000d10+20000")]
        [TestCase(30_000, 180_000, "1515d100+3d6+28482")]
        [TestCase(30_000, 240_000, "2121d100+3d8+27876")]
        [TestCase(30_000, 300_000, "2727d100+3d10+27270")]
        [TestCase(30_000, 360_000, "3333d100+3d12+26664")]
        [TestCase(40_000, 160_000, "1212d100+4d4+38784")]
        [TestCase(40_000, 240_000, "2020d100+4d6+37976")]
        [TestCase(40_000, 320_000, "2828d100+4d8+37168")]
        [TestCase(40_000, 400_000, "3636d100+4d10+36360")]
        [TestCase(40_000, 480_000, "4444d100+4d12+35552")]
        [TestCase(50_000, 200_000, "1515d100+3d6+48482")]
        [TestCase(50_000, 300_000, "2525d100+5d6+47470")]
        [TestCase(50_000, 400_000, "3535d100+5d8+46460")]
        [TestCase(50_000, 500_000, "4545d100+5d10+45450")]
        [TestCase(50_000, 600_000, "5555d100+5d12+44440")]
        [TestCase(60_000, 240_000, "1818d100+2d10+58180")]
        [TestCase(60_000, 360_000, "3030d100+6d6+56964")]
        [TestCase(60_000, 480_000, "4242d100+6d8+55752")]
        [TestCase(60_000, 600_000, "5454d100+6d10+54540")]
        [TestCase(60_000, 720_000, "6666d100+6d12+53328")]
        [TestCase(70_000, 280_000, "2121d100+3d8+67876")]
        [TestCase(70_000, 420_000, "3535d100+5d8+66460")]
        [TestCase(70_000, 560_000, "4949d100+7d8+65044")]
        [TestCase(70_000, 700_000, "6363d100+7d10+63630")]
        [TestCase(70_000, 840_000, "7777d100+7d12+62216")]
        [TestCase(90_210, 90_210, "90210")]
        public void GetRollWithFewestDice(int lower, int upper, string expectedRoll)
        {
            var roll = RollHelper.GetRollWithFewestDice(lower, upper);
            Assert.That(roll, Is.EqualTo(expectedRoll));
        }

        [TestCase(1, 2, 2, "1")]
        [TestCase(6, 7, 9, "1d3")]
        [TestCase(6, 8, 10, "1d3+1")]
        [TestCase(6, 10, 18, "4d3")]
        [TestCase(9, 14, 27, "13d2-8")]
        [TestCase(9, 15, 27, "4d4+2")]
        [TestCase(12, 19, 36, "17d2-10")]
        [TestCase(15, 22, 45, "23d2-16")]
        public void GetRollWithFewestDice_WithBaseAmount(int baseAmount, int lower, int upper, string expectedRoll)
        {
            var roll = RollHelper.GetRollWithFewestDice(baseAmount, lower, upper);
            Assert.That(roll, Is.EqualTo(expectedRoll));
        }

        [TestCase(-2, -2, "-2")]
        [TestCase(-2, -1, "1d2-3")]
        [TestCase(-2, 0, "1d3-3")]
        [TestCase(-2, 2, "2d3-4")]
        [TestCase(-2, 3, "1d6-3")]
        [TestCase(-1, -1, "-1")]
        [TestCase(-1, 0, "1d2-2")]
        [TestCase(-1, 1, "1d3-2")]
        [TestCase(-1, 3, "2d3-3")]
        [TestCase(-1, 4, "1d6-2")]
        [TestCase(0, 0, "0")]
        [TestCase(0, 1, "1d2-1")]
        [TestCase(0, 2, "1d3-1")]
        [TestCase(0, 4, "2d3-2")]
        [TestCase(0, 5, "1d6-1")]
        [TestCase(1, 1, "1")]
        [TestCase(1, 2, "1d2")]
        [TestCase(1, 3, "1d3")]
        [TestCase(1, 4, "1d4")]
        [TestCase(1, 5, "2d3-1")]
        [TestCase(1, 6, "1d6")]
        [TestCase(1, 7, "2d4-1")]
        [TestCase(1, 8, "1d8")]
        [TestCase(1, 9, "1d8+1d2-1")]
        [TestCase(1, 10, "1d10")]
        [TestCase(1, 11, "2d6-1")]
        [TestCase(1, 12, "1d12")]
        [TestCase(1, 20, "1d20")]
        [TestCase(1, 36, "1d20+1d10+1d8-2")]
        [TestCase(1, 48, "2d20+1d10-2")]
        [TestCase(1, 52, "2d20+1d12+1d3-3")]
        [TestCase(1, 100, "1d100")]
        [TestCase(1, 103, "1d100+1d4-1")]
        [TestCase(2, 2, "2")]
        [TestCase(2, 3, "1d2+1")]
        [TestCase(2, 4, "1d3+1")]
        [TestCase(2, 5, "1d4+1")]
        [TestCase(2, 6, "2d3")]
        [TestCase(2, 7, "1d6+1")]
        [TestCase(2, 8, "2d4")]
        [TestCase(2, 10, "1d8+1d2")]
        [TestCase(2, 12, "2d6")]
        [TestCase(2, 13, "1d12+1")]
        [TestCase(2, 15, "1d12+1d3")]
        [TestCase(2, 20, "2d10")]
        [TestCase(2, 24, "2d12")]
        [TestCase(2, 40, "2d20")]
        [TestCase(2, 200, "2d100")]
        [TestCase(3, 3, "3")]
        [TestCase(3, 4, "1d2+2")]
        [TestCase(3, 5, "1d3+2")]
        [TestCase(3, 6, "1d4+2")]
        [TestCase(3, 8, "1d6+2")]
        [TestCase(3, 9, "2d4+1")]
        [TestCase(3, 10, "1d8+2")]
        [TestCase(3, 12, "1d10+2")]
        [TestCase(3, 13, "2d6+1")]
        [TestCase(3, 18, "3d6")]
        [TestCase(3, 20, "1d12+2d4")]
        [TestCase(3, 24, "1d20+1d3+1")]
        [TestCase(3, 28, "1d20+2d4")]
        [TestCase(3, 30, "3d10")]
        [TestCase(3, 36, "3d12")]
        [TestCase(4, 4, "4")]
        [TestCase(4, 5, "1d2+3")]
        [TestCase(4, 6, "1d3+3")]
        [TestCase(4, 7, "1d4+3")]
        [TestCase(4, 8, "2d3+2")]
        [TestCase(4, 9, "1d6+3")]
        [TestCase(4, 10, "2d4+2")]
        [TestCase(4, 12, "1d8+1d2+2")]
        [TestCase(4, 16, "1d12+1d2+2")]
        [TestCase(4, 24, "1d20+1d2+2")]
        [TestCase(4, 32, "1d20+1d10+2")]
        [TestCase(4, 40, "4d10")]
        [TestCase(4, 48, "4d12")]
        [TestCase(5, 5, "5")]
        [TestCase(5, 8, "1d4+4")]
        [TestCase(5, 9, "2d3+3")]
        [TestCase(5, 10, "1d6+4")]
        [TestCase(5, 12, "1d8+4")]
        [TestCase(5, 13, "1d8+1d2+3")]
        [TestCase(5, 14, "1d10+4")]
        [TestCase(5, 16, "1d12+4")]
        [TestCase(5, 18, "1d12+1d3+3")]
        [TestCase(5, 20, "3d6+2")]
        [TestCase(5, 30, "1d20+2d4+2")]
        [TestCase(5, 40, "1d20+1d10+1d8+2")]
        [TestCase(5, 50, "2d20+1d8+2")]
        [TestCase(5, 60, "5d12")]
        [TestCase(6, 6, "6")]
        [TestCase(6, 7, "1d2+5")]
        [TestCase(6, 8, "1d3+5")]
        [TestCase(6, 9, "1d4+5")]
        [TestCase(6, 10, "2d3+4")]
        [TestCase(6, 11, "1d6+5")]
        [TestCase(6, 13, "1d8+5")]
        [TestCase(6, 15, "1d10+5")]
        [TestCase(6, 18, "1d12+1d2+4")]
        [TestCase(6, 20, "2d8+4")]
        [TestCase(6, 24, "2d10+4")]
        [TestCase(6, 30, "1d20+1d6+4")]
        [TestCase(6, 36, "1d20+1d12+4")]
        [TestCase(6, 45, "2d20+1d2+3")]
        [TestCase(7, 7, "7")]
        [TestCase(7, 10, "1d4+6")]
        [TestCase(7, 11, "2d3+5")]
        [TestCase(7, 12, "1d6+6")]
        [TestCase(7, 16, "1d10+6")]
        [TestCase(7, 18, "1d12+6")]
        [TestCase(7, 30, "1d20+2d3+4")]
        [TestCase(7, 42, "1d20+1d10+1d8+4")]
        [TestCase(7, 50, "2d20+1d6+4")]
        [TestCase(8, 8, "8")]
        [TestCase(8, 9, "1d2+7")]
        [TestCase(8, 18, "2d6+6")]
        [TestCase(8, 16, "1d8+1d2+6")]
        [TestCase(9, 9, "9")]
        [TestCase(9, 14, "1d6+8")]
        [TestCase(9, 16, "1d8+8")]
        [TestCase(9, 30, "1d20+1d3+7")]
        [TestCase(10, 10, "10")]
        [TestCase(10, 11, "1d2+9")]
        [TestCase(10, 20, "2d6+8")]
        [TestCase(10, 24, "2d8+8")]
        [TestCase(10, 40, "1d20+1d12+8")]
        [TestCase(10, 50, "2d20+1d3+7")]
        [TestCase(10, 60, "2d20+1d8+1d6+6")]
        [TestCase(10, 80, "3d20+1d12+1d3+5")]
        [TestCase(10, 100, "4d20+2d8+4")]
        [TestCase(10, 120, "1d100+1d12+8")]
        [TestCase(11, 11, "11")]
        [TestCase(11, 20, "1d10+10")]
        [TestCase(11, 40, "1d20+2d6+8")]
        [TestCase(12, 12, "12")]
        [TestCase(12, 13, "1d2+11")]
        [TestCase(12, 22, "2d6+10")]
        [TestCase(12, 24, "1d12+1d2+10")]
        [TestCase(12, 30, "2d10+10")]
        [TestCase(13, 13, "13")]
        [TestCase(14, 14, "14")]
        [TestCase(14, 15, "1d2+13")]
        [TestCase(15, 15, "15")]
        [TestCase(15, 30, "3d6+12")]
        [TestCase(15, 50, "1d20+1d10+1d8+12")]
        [TestCase(15, 150, "1d100+4d10+10")]
        [TestCase(16, 16, "16")]
        [TestCase(16, 17, "1d2+15")]
        [TestCase(17, 17, "17")]
        [TestCase(18, 18, "18")]
        [TestCase(18, 19, "1d2+17")]
        [TestCase(18, 72, "2d20+1d10+1d8+14")]
        [TestCase(19, 19, "19")]
        [TestCase(20, 20, "20")]
        [TestCase(20, 50, "1d20+1d12+18")]
        [TestCase(20, 80, "3d20+1d4+16")]
        [TestCase(20, 150, "1d100+2d12+1d10+16")]
        [TestCase(20, 160, "1d100+2d20+1d4+16")]
        [TestCase(20, 200, "1d100+4d20+1d6+14")]
        [TestCase(20, 240, "2d100+2d12+16")]
        [TestCase(21, 30, "1d10+20")]
        [TestCase(21, 40, "1d20+20")]
        [TestCase(30, 50, "1d20+1d2+28")]
        [TestCase(30, 60, "1d20+1d12+28")]
        [TestCase(30, 100, "3d20+1d12+1d3+25")]
        [TestCase(30, 120, "4d20+2d8+24")]
        [TestCase(30, 180, "1d100+2d20+1d12+1d3+25")]
        [TestCase(30, 240, "2d100+1d8+1d6+26")]
        [TestCase(30, 300, "2d100+3d20+3d6+22")]
        [TestCase(30, 360, "3d100+3d12+24")]
        [TestCase(40, 160, "1d100+1d20+1d3+37")]
        [TestCase(40, 240, "2d100+1d3+37")]
        [TestCase(40, 320, "2d100+4d20+2d4+32")]
        [TestCase(40, 400, "3d100+3d20+2d4+32")]
        [TestCase(40, 480, "4d100+4d12+32")]
        [TestCase(42, 42, "42")]
        [TestCase(42, 96, "2d20+1d10+1d8+38")]
        [TestCase(42, 600, "5d100+3d20+2d4+32")]
        [TestCase(42, 783, "7d100+2d20+2d6+31")]
        [TestCase(42, 1336, "13d100+1d8+28")]
        [TestCase(42, 1337, "13d100+1d6+1d4+27")]
        [TestCase(42, 8245, "82d100+4d20+1d10-45")]
        [TestCase(42, 9266, "93d100+1d12+2d4-54")]
        [TestCase(42, 90210, "910d100+4d20+1d3-873")]
        [TestCase(45, 150, "1d100+2d4+42")]
        [TestCase(50, 200, "1d100+2d20+1d12+1d3+45")]
        [TestCase(50, 300, "2d100+2d20+2d8+44")]
        [TestCase(60, 240, "1d100+4d20+1d6+54")]
        [TestCase(60, 360, "3d100+1d4+56")]
        [TestCase(70, 160, "4d20+2d8+64")]
        [TestCase(70, 420, "3d100+4d12+1d10+62")]
        [TestCase(96, 96, "96")]
        [TestCase(96, 600, "5d100+1d10+90")]
        [TestCase(96, 783, "6d100+4d20+1d12+2d4+83")]
        [TestCase(96, 1336, "12d100+2d20+2d8+80")]
        [TestCase(96, 1337, "12d100+4d12+1d10+79")]
        [TestCase(96, 8245, "82d100+2d12+1d10+11")]
        [TestCase(96, 9266, "92d100+3d20+1d6")]
        [TestCase(96, 90210, "910d100+1d20+1d6-816")]
        [TestCase(100, 400, "3d100+1d4+96")]
        [TestCase(100, 600, "5d100+1d6+94")]
        [TestCase(100, 800, "7d100+1d8+92")]
        [TestCase(100, 1000, "9d100+1d10+90")]
        [TestCase(100, 1200, "11d100+1d12+88")]
        [TestCase(200, 800, "6d100+2d4+192")]
        [TestCase(200, 1200, "10d100+2d6+188")]
        [TestCase(200, 1600, "14d100+2d8+184")]
        [TestCase(200, 2000, "18d100+2d10+180")]
        [TestCase(300, 1200, "9d100+1d10+290")]
        [TestCase(300, 1800, "15d100+3d6+282")]
        [TestCase(300, 2400, "21d100+1d20+1d3+277")]
        [TestCase(300, 3000, "27d100+3d10+270")]
        [TestCase(300, 3600, "33d100+3d12+264")]
        [TestCase(400, 1600, "12d100+1d8+1d6+386")]
        [TestCase(400, 2400, "20d100+1d12+1d10+378")]
        [TestCase(400, 3200, "28d100+1d20+1d10+370")]
        [TestCase(400, 4000, "36d100+4d10+360")]
        [TestCase(400, 4800, "44d100+4d12+352")]
        [TestCase(437, 1204, "7d100+3d20+1d12+2d4+424")]
        [TestCase(500, 2000, "15d100+3d6+482")]
        [TestCase(500, 3000, "25d100+2d10+1d8+472")]
        [TestCase(600, 600, "600")]
        [TestCase(600, 783, "1d100+4d20+1d6+1d4+593")]
        [TestCase(600, 1336, "7d100+2d20+1d6+590")]
        [TestCase(600, 1337, "7d100+4d12+589")]
        [TestCase(600, 2400, "18d100+2d10+580")]
        [TestCase(600, 3600, "30d100+1d20+1d12+568")]
        [TestCase(600, 8245, "77d100+2d12+521")]
        [TestCase(600, 9266, "87d100+4d12+1d10+508")]
        [TestCase(600, 90210, "905d100+3d6-308")]
        [TestCase(700, 4200, "35d100+1d20+1d10+1d8+662")]
        [TestCase(783, 783, "783")]
        [TestCase(783, 1336, "5d100+3d20+1d2+774")]
        [TestCase(783, 1337, "5d100+3d20+1d3+774")]
        [TestCase(783, 8245, "75d100+1d20+2d10+705")]
        [TestCase(783, 9266, "85d100+3d20+1d12+694")]
        [TestCase(783, 90210, "903d100+1d20+1d12-122")]
        [TestCase(1000, 4000, "30d100+1d20+1d12+968")]
        [TestCase(1000, 6000, "50d100+2d20+1d8+1d6+946")]
        [TestCase(1000, 8000, "70d100+3d20+1d12+1d3+925")]
        [TestCase(1000, 10_000, "90d100+4d20+2d8+904")]
        [TestCase(1000, 12_000, "111d100+1d12+888")]
        [TestCase(1336, 1336, "1336")]
        [TestCase(1336, 1337, "1d2+1335")]
        [TestCase(1336, 8245, "69d100+4d20+1d3+1262")]
        [TestCase(1336, 9266, "80d100+2d6+1254")]
        [TestCase(1336, 90210, "897d100+3d20+2d8+434")]
        [TestCase(1337, 1337, "1337")]
        [TestCase(1337, 8245, "69d100+4d20+1d2+1263")]
        [TestCase(1337, 9266, "80d100+1d10+1256")]
        [TestCase(1337, 90210, "897d100+3d20+1d12+1d3+435")]
        [TestCase(2000, 8000, "60d100+3d20+1d4+1936")]
        [TestCase(2000, 12_000, "101d100+1d2+1898")]
        [TestCase(2000, 16_000, "141d100+2d20+1d4+1856")]
        [TestCase(2000, 20_000, "181d100+4d20+1d6+1814")]
        [TestCase(3000, 12_000, "90d100+4d20+2d8+2904")]
        [TestCase(3000, 18_000, "151d100+2d20+1d12+1d3+2845")]
        [TestCase(3000, 24_000, "212d100+1d8+1d6+2786")]
        [TestCase(3000, 30_000, "272d100+3d20+3d6+2722")]
        [TestCase(3000, 36_000, "333d100+3d12+2664")]
        [TestCase(4000, 16_000, "121d100+1d20+1d3+3877")]
        [TestCase(4000, 24_000, "202d100+1d3+3797")]
        [TestCase(4000, 32_000, "282d100+4d20+2d4+3712")]
        [TestCase(4000, 40_000, "363d100+3d20+2d4+3632")]
        [TestCase(4000, 48_000, "444d100+4d12+3552")]
        [TestCase(5000, 20_000, "151d100+2d20+1d12+1d3+4845")]
        [TestCase(5000, 30_000, "252d100+2d20+2d8+4744")]
        [TestCase(6000, 24_000, "181d100+4d20+1d6+5814")]
        [TestCase(6000, 36_000, "303d100+1d4+5696")]
        [TestCase(7000, 42_000, "353d100+4d12+1d10+6642")]
        [TestCase(8245, 8245, "8245")]
        [TestCase(8245, 9266, "10d100+2d12+1d10+8232")]
        [TestCase(8245, 90210, "827d100+4d20+1d10+1d8+7412")]
        [TestCase(9266, 9266, "9266")]
        [TestCase(9266, 90210, "817d100+3d20+2d3+8444")]
        [TestCase(10_000, 40_000, "303d100+1d4+9696")]
        [TestCase(10_000, 60_000, "505d100+1d6+9494")]
        [TestCase(10_000, 80_000, "707d100+1d8+9292")]
        [TestCase(10_000, 100_000, "909d100+1d10+9090")]
        [TestCase(10_000, 120_000, "1111d100+1d12+8888")]
        [TestCase(20_000, 80_000, "606d100+2d4+19392")]
        [TestCase(20_000, 120_000, "1010d100+2d6+18988")]
        [TestCase(20_000, 160_000, "1414d100+2d8+18584")]
        [TestCase(20_000, 200_000, "1818d100+2d10+18180")]
        [TestCase(30_000, 120_000, "909d100+1d10+29090")]
        [TestCase(30_000, 180_000, "1515d100+3d6+28482")]
        [TestCase(30_000, 240_000, "2121d100+1d20+1d3+27877")]
        [TestCase(30_000, 300_000, "2727d100+3d10+27270")]
        [TestCase(30_000, 360_000, "3333d100+3d12+26664")]
        [TestCase(40_000, 160_000, "1212d100+1d8+1d6+38786")]
        [TestCase(40_000, 240_000, "2020d100+1d12+1d10+37978")]
        [TestCase(40_000, 320_000, "2828d100+1d20+1d10+37170")]
        [TestCase(40_000, 400_000, "3636d100+4d10+36360")]
        [TestCase(40_000, 480_000, "4444d100+4d12+35552")]
        [TestCase(50_000, 200_000, "1515d100+3d6+48482")]
        [TestCase(50_000, 300_000, "2525d100+2d10+1d8+47472")]
        [TestCase(60_000, 240_000, "1818d100+2d10+58180")]
        [TestCase(60_000, 360_000, "3030d100+1d20+1d12+56968")]
        [TestCase(70_000, 420_000, "3535d100+1d20+1d10+1d8+66462")]
        [TestCase(90_210, 90_210, "90210")]
        public void GetRollWithMostEvenDistribution(int lower, int upper, string expectedRoll)
        {
            var roll = RollHelper.GetRollWithMostEvenDistribution(lower, upper);
            Assert.That(roll, Is.EqualTo(expectedRoll));
        }

        [TestCase(1, 2, 2, "1")]
        [TestCase(6, 7, 9, "1d3")]
        [TestCase(6, 8, 10, "1d3+1")]
        [TestCase(6, 10, 18, "1d8+1d2+2")]
        [TestCase(9, 14, 27, "1d12+1d3+3")]
        [TestCase(9, 15, 27, "1d12+1d2+4")]
        [TestCase(12, 19, 36, "1d12+2d4+4")]
        [TestCase(15, 22, 45, "1d20+2d3+4")]
        public void GetRollWithMostEvenDistribution_WithBaseAmount(int baseAmount, int lower, int upper, string expectedRoll)
        {
            var roll = RollHelper.GetRollWithMostEvenDistribution(baseAmount, lower, upper);
            Assert.That(roll, Is.EqualTo(expectedRoll));
        }

        [TestCase(-2, -2, "-2")]
        [TestCase(-2, -1, "1d2-3")]
        [TestCase(-2, 0, "1d3-3")]
        [TestCase(-2, 2, "2d3-4")]
        [TestCase(-2, 3, "1d6-3")]
        [TestCase(-1, -1, "-1")]
        [TestCase(-1, 0, "1d2-2")]
        [TestCase(-1, 1, "1d3-2")]
        [TestCase(-1, 3, "2d3-3")]
        [TestCase(-1, 4, "1d6-2")]
        [TestCase(0, 0, "0")]
        [TestCase(0, 1, "1d2-1")]
        [TestCase(0, 2, "1d3-1")]
        [TestCase(0, 4, "2d3-2")]
        [TestCase(0, 5, "1d6-1")]
        [TestCase(1, 1, "1")]
        [TestCase(1, 2, "1d2")]
        [TestCase(1, 3, "1d3")]
        [TestCase(1, 4, "1d4")]
        [TestCase(1, 5, "2d3-1")]
        [TestCase(1, 6, "1d6")]
        [TestCase(1, 7, "2d4-1")]
        [TestCase(1, 8, "1d8")]
        [TestCase(1, 9, "(1d3-1)*3+1d3")]
        [TestCase(1, 10, "1d10")]
        [TestCase(1, 11, "2d6-1")]
        [TestCase(1, 12, "1d12")]
        [TestCase(1, 20, "1d20")]
        [TestCase(1, 36, "(1d12-1)*3+1d3")]
        [TestCase(1, 48, "(1d12-1)*4+1d4")]
        [TestCase(1, 52, "2d20+1d12+1d3-3")]
        [TestCase(1, 100, "1d100")]
        [TestCase(1, 103, "1d100+1d4-1")]
        [TestCase(2, 2, "2")]
        [TestCase(2, 3, "1d2+1")]
        [TestCase(2, 4, "1d3+1")]
        [TestCase(2, 5, "1d4+1")]
        [TestCase(2, 6, "2d3")]
        [TestCase(2, 7, "1d6+1")]
        [TestCase(2, 8, "2d4")]
        [TestCase(2, 10, "(1d3-1)*3+1d3+1")]
        [TestCase(2, 12, "2d6")]
        [TestCase(2, 13, "1d12+1")]
        [TestCase(2, 15, "1d12+1d3")]
        [TestCase(2, 20, "2d10")]
        [TestCase(2, 24, "2d12")]
        [TestCase(2, 40, "2d20")]
        [TestCase(2, 200, "2d100")]
        [TestCase(3, 3, "3")]
        [TestCase(3, 4, "1d2+2")]
        [TestCase(3, 5, "1d3+2")]
        [TestCase(3, 6, "1d4+2")]
        [TestCase(3, 8, "1d6+2")]
        [TestCase(3, 9, "2d4+1")]
        [TestCase(3, 10, "1d8+2")]
        [TestCase(3, 12, "1d10+2")]
        [TestCase(3, 13, "2d6+1")]
        [TestCase(3, 18, "(1d8-1)*2+1d2+2")]
        [TestCase(3, 20, "(1d6-1)*3+1d3+2")]
        [TestCase(3, 24, "1d20+1d3+1")]
        [TestCase(3, 28, "1d20+2d4")]
        [TestCase(3, 30, "3d10")]
        [TestCase(3, 36, "3d12")]
        [TestCase(4, 4, "4")]
        [TestCase(4, 5, "1d2+3")]
        [TestCase(4, 6, "1d3+3")]
        [TestCase(4, 7, "1d4+3")]
        [TestCase(4, 8, "2d3+2")]
        [TestCase(4, 9, "1d6+3")]
        [TestCase(4, 10, "2d4+2")]
        [TestCase(4, 12, "(1d3-1)*3+1d3+3")]
        [TestCase(4, 16, "1d12+1d2+2")]
        [TestCase(4, 24, "1d20+1d2+2")]
        [TestCase(4, 32, "1d20+1d10+2")]
        [TestCase(4, 40, "4d10")]
        [TestCase(4, 48, "4d12")]
        [TestCase(5, 5, "5")]
        [TestCase(5, 8, "1d4+4")]
        [TestCase(5, 9, "2d3+3")]
        [TestCase(5, 10, "1d6+4")]
        [TestCase(5, 12, "1d8+4")]
        [TestCase(5, 13, "(1d3-1)*3+1d3+4")]
        [TestCase(5, 14, "1d10+4")]
        [TestCase(5, 16, "1d12+4")]
        [TestCase(5, 18, "1d12+1d3+3")]
        [TestCase(5, 20, "(1d8-1)*2+1d2+4")]
        [TestCase(5, 30, "1d20+2d4+2")]
        [TestCase(5, 40, "(1d12-1)*3+1d3+4")]
        [TestCase(5, 50, "2d20+1d8+2")]
        [TestCase(5, 60, "5d12")]
        [TestCase(6, 6, "6")]
        [TestCase(6, 7, "1d2+5")]
        [TestCase(6, 8, "1d3+5")]
        [TestCase(6, 9, "1d4+5")]
        [TestCase(6, 10, "2d3+4")]
        [TestCase(6, 11, "1d6+5")]
        [TestCase(6, 13, "1d8+5")]
        [TestCase(6, 15, "1d10+5")]
        [TestCase(6, 18, "1d12+1d2+4")]
        [TestCase(6, 20, "2d8+4")]
        [TestCase(6, 24, "2d10+4")]
        [TestCase(6, 30, "1d20+1d6+4")]
        [TestCase(6, 36, "1d20+1d12+4")]
        [TestCase(6, 45, "(1d20-1)*2+1d2+5")]
        [TestCase(7, 7, "7")]
        [TestCase(7, 10, "1d4+6")]
        [TestCase(7, 11, "2d3+5")]
        [TestCase(7, 12, "1d6+6")]
        [TestCase(7, 16, "1d10+6")]
        [TestCase(7, 18, "1d12+6")]
        [TestCase(7, 30, "(1d12-1)*2+1d2+6")]
        [TestCase(7, 42, "(1d12-1)*3+1d3+6")]
        [TestCase(7, 50, "2d20+1d6+4")]
        [TestCase(8, 8, "8")]
        [TestCase(8, 9, "1d2+7")]
        [TestCase(8, 18, "2d6+6")]
        [TestCase(8, 16, "(1d3-1)*3+1d3+7")]
        [TestCase(9, 9, "9")]
        [TestCase(9, 14, "1d6+8")]
        [TestCase(9, 16, "1d8+8")]
        [TestCase(9, 30, "1d20+1d3+7")]
        [TestCase(10, 10, "10")]
        [TestCase(10, 11, "1d2+9")]
        [TestCase(10, 20, "2d6+8")]
        [TestCase(10, 24, "2d8+8")]
        [TestCase(10, 40, "1d20+1d12+8")]
        [TestCase(10, 50, "2d20+1d3+7")]
        [TestCase(10, 60, "2d20+1d8+1d6+6")]
        [TestCase(10, 80, "3d20+1d12+1d3+5")]
        [TestCase(10, 100, "4d20+2d8+4")]
        [TestCase(10, 120, "1d100+1d12+8")]
        [TestCase(11, 11, "11")]
        [TestCase(11, 20, "1d10+10")]
        [TestCase(11, 40, "(1d10-1)*3+1d3+10")]
        [TestCase(12, 12, "12")]
        [TestCase(12, 13, "1d2+11")]
        [TestCase(12, 22, "2d6+10")]
        [TestCase(12, 24, "1d12+1d2+10")]
        [TestCase(12, 30, "2d10+10")]
        [TestCase(13, 13, "13")]
        [TestCase(14, 14, "14")]
        [TestCase(14, 15, "1d2+13")]
        [TestCase(15, 15, "15")]
        [TestCase(15, 30, "(1d8-1)*2+1d2+14")]
        [TestCase(15, 50, "(1d12-1)*3+1d3+14")]
        [TestCase(15, 150, "1d100+4d10+10")]
        [TestCase(16, 16, "16")]
        [TestCase(16, 17, "1d2+15")]
        [TestCase(17, 17, "17")]
        [TestCase(18, 18, "18")]
        [TestCase(18, 19, "1d2+17")]
        [TestCase(18, 72, "2d20+1d10+1d8+14")]
        [TestCase(19, 19, "19")]
        [TestCase(20, 20, "20")]
        [TestCase(20, 50, "1d20+1d12+18")]
        [TestCase(20, 80, "3d20+1d4+16")]
        [TestCase(20, 150, "1d100+2d12+1d10+16")]
        [TestCase(20, 160, "1d100+2d20+1d4+16")]
        [TestCase(20, 200, "1d100+4d20+1d6+14")]
        [TestCase(20, 240, "2d100+2d12+16")]
        [TestCase(21, 30, "1d10+20")]
        [TestCase(21, 40, "1d20+20")]
        [TestCase(30, 50, "1d20+1d2+28")]
        [TestCase(30, 60, "1d20+1d12+28")]
        [TestCase(30, 100, "3d20+1d12+1d3+25")]
        [TestCase(30, 120, "4d20+2d8+24")]
        [TestCase(30, 180, "1d100+2d20+1d12+1d3+25")]
        [TestCase(30, 240, "2d100+1d8+1d6+26")]
        [TestCase(30, 300, "2d100+3d20+3d6+22")]
        [TestCase(30, 360, "3d100+3d12+24")]
        [TestCase(40, 160, "1d100+1d20+1d3+37")]
        [TestCase(40, 240, "2d100+1d3+37")]
        [TestCase(40, 320, "2d100+4d20+2d4+32")]
        [TestCase(40, 400, "3d100+3d20+2d4+32")]
        [TestCase(40, 480, "4d100+4d12+32")]
        [TestCase(42, 42, "42")]
        [TestCase(42, 96, "2d20+1d10+1d8+38")]
        [TestCase(42, 600, "5d100+3d20+2d4+32")]
        [TestCase(42, 783, "7d100+2d20+2d6+31")]
        [TestCase(42, 1336, "13d100+1d8+28")]
        [TestCase(42, 1337, "(1d12-1)*108+(1d12-1)*9+(1d3-1)*3+1d3+41")]
        [TestCase(42, 8245, "82d100+4d20+1d10-45")]
        [TestCase(42, 9266, "93d100+1d12+2d4-54")]
        [TestCase(42, 90210, "910d100+4d20+1d3-873")]
        [TestCase(45, 150, "1d100+2d4+42")]
        [TestCase(50, 200, "1d100+2d20+1d12+1d3+45")]
        [TestCase(50, 300, "2d100+2d20+2d8+44")]
        [TestCase(60, 240, "1d100+4d20+1d6+54")]
        [TestCase(60, 360, "3d100+1d4+56")]
        [TestCase(70, 160, "4d20+2d8+64")]
        [TestCase(70, 420, "3d100+4d12+1d10+62")]
        [TestCase(96, 96, "96")]
        [TestCase(96, 600, "5d100+1d10+90")]
        [TestCase(96, 783, "6d100+4d20+1d12+2d4+83")]
        [TestCase(96, 1336, "12d100+2d20+2d8+80")]
        [TestCase(96, 1337, "12d100+4d12+1d10+79")]
        [TestCase(96, 8245, "82d100+2d12+1d10+11")]
        [TestCase(96, 9266, "92d100+3d20+1d6")]
        [TestCase(96, 90210, "910d100+1d20+1d6-816")]
        [TestCase(100, 400, "3d100+1d4+96")]
        [TestCase(100, 600, "5d100+1d6+94")]
        [TestCase(100, 800, "7d100+1d8+92")]
        [TestCase(100, 1000, "9d100+1d10+90")]
        [TestCase(100, 1200, "11d100+1d12+88")]
        [TestCase(200, 800, "6d100+2d4+192")]
        [TestCase(200, 1200, "10d100+2d6+188")]
        [TestCase(200, 1600, "14d100+2d8+184")]
        [TestCase(200, 2000, "18d100+2d10+180")]
        [TestCase(300, 1200, "9d100+1d10+290")]
        [TestCase(300, 1800, "15d100+3d6+282")]
        [TestCase(300, 2400, "21d100+1d20+1d3+277")]
        [TestCase(300, 3000, "27d100+3d10+270")]
        [TestCase(300, 3600, "33d100+3d12+264")]
        [TestCase(400, 1600, "12d100+1d8+1d6+386")]
        [TestCase(400, 2400, "20d100+1d12+1d10+378")]
        [TestCase(400, 3200, "28d100+1d20+1d10+370")]
        [TestCase(400, 4000, "36d100+4d10+360")]
        [TestCase(400, 4800, "44d100+4d12+352")]
        [TestCase(437, 1204, "(1d12-1)*64+(1d8-1)*8+1d8+436")]
        [TestCase(500, 2000, "15d100+3d6+482")]
        [TestCase(500, 3000, "25d100+2d10+1d8+472")]
        [TestCase(600, 600, "600")]
        [TestCase(600, 783, "1d100+4d20+1d6+1d4+593")]
        [TestCase(600, 1336, "7d100+2d20+1d6+590")]
        [TestCase(600, 1337, "7d100+4d12+589")]
        [TestCase(600, 2400, "18d100+2d10+580")]
        [TestCase(600, 3600, "30d100+1d20+1d12+568")]
        [TestCase(600, 8245, "77d100+2d12+521")]
        [TestCase(600, 9266, "87d100+4d12+1d10+508")]
        [TestCase(600, 90210, "905d100+3d6-308")]
        [TestCase(700, 4200, "35d100+1d20+1d10+1d8+662")]
        [TestCase(783, 783, "783")]
        [TestCase(783, 1336, "5d100+3d20+1d2+774")]
        [TestCase(783, 1337, "5d100+3d20+1d3+774")]
        [TestCase(783, 8245, "75d100+1d20+2d10+705")]
        [TestCase(783, 9266, "85d100+3d20+1d12+694")]
        [TestCase(783, 90210, "903d100+1d20+1d12-122")]
        [TestCase(1000, 4000, "30d100+1d20+1d12+968")]
        [TestCase(1000, 6000, "50d100+2d20+1d8+1d6+946")]
        [TestCase(1000, 8000, "70d100+3d20+1d12+1d3+925")]
        [TestCase(1000, 10_000, "90d100+4d20+2d8+904")]
        [TestCase(1000, 12_000, "111d100+1d12+888")]
        [TestCase(1336, 1336, "1336")]
        [TestCase(1336, 1337, "1d2+1335")]
        [TestCase(1336, 8245, "69d100+4d20+1d3+1262")]
        [TestCase(1336, 9266, "80d100+2d6+1254")]
        [TestCase(1336, 90210, "897d100+3d20+2d8+434")]
        [TestCase(1337, 1337, "1337")]
        [TestCase(1337, 8245, "69d100+4d20+1d2+1263")]
        [TestCase(1337, 9266, "80d100+1d10+1256")]
        [TestCase(1337, 90210, "897d100+3d20+1d12+1d3+435")]
        [TestCase(2000, 8000, "60d100+3d20+1d4+1936")]
        [TestCase(2000, 12_000, "101d100+1d2+1898")]
        [TestCase(2000, 16_000, "141d100+2d20+1d4+1856")]
        [TestCase(2000, 20_000, "181d100+4d20+1d6+1814")]
        [TestCase(2000, 24_000, "222d100+2d12+1776")]
        [TestCase(3000, 12_000, "90d100+4d20+2d8+2904")]
        [TestCase(3000, 18_000, "151d100+2d20+1d12+1d3+2845")]
        [TestCase(3000, 24_000, "212d100+1d8+1d6+2786")]
        [TestCase(3000, 30_000, "272d100+3d20+3d6+2722")]
        [TestCase(3000, 36_000, "333d100+3d12+2664")]
        [TestCase(4000, 16_000, "121d100+1d20+1d3+3877")]
        [TestCase(4000, 24_000, "202d100+1d3+3797")]
        [TestCase(4000, 32_000, "282d100+4d20+2d4+3712")]
        [TestCase(4000, 40_000, "363d100+3d20+2d4+3632")]
        [TestCase(4000, 48_000, "444d100+4d12+3552")]
        [TestCase(5000, 20_000, "151d100+2d20+1d12+1d3+4845")]
        [TestCase(5000, 30_000, "252d100+2d20+2d8+4744")]
        [TestCase(5000, 40_000, "353d100+4d12+1d10+4642")]
        [TestCase(5000, 50_000, "454d100+2d20+1d10+1d8+4542")]
        [TestCase(5000, 60_000, "555d100+5d12+4440")]
        [TestCase(6000, 24_000, "181d100+4d20+1d6+5814")]
        [TestCase(6000, 36_000, "303d100+1d4+5696")]
        [TestCase(6000, 48_000, "424d100+1d20+1d6+5574")]
        [TestCase(6000, 60_000, "545d100+2d20+1d8+5452")]
        [TestCase(6000, 72_000, "666d100+3d20+1d10+5330")]
        [TestCase(7000, 28_000, "212d100+1d8+1d6+6786")]
        [TestCase(7000, 42_000, "353d100+4d12+1d10+6642")]
        [TestCase(7000, 56_000, "494d100+4d20+2d10+6500")]
        [TestCase(7000, 70_000, "636d100+4d10+6360")]
        [TestCase(7000, 84_000, "777d100+4d20+1d2+6218")]
        [TestCase(8245, 8245, "8245")]
        [TestCase(8245, 9266, "10d100+2d12+1d10+8232")]
        [TestCase(8245, 90210, "827d100+4d20+1d10+1d8+7412")]
        [TestCase(9266, 9266, "9266")]
        [TestCase(9266, 90210, "817d100+3d20+2d3+8444")]
        [TestCase(10_000, 40_000, "303d100+1d4+9696")]
        [TestCase(10_000, 60_000, "505d100+1d6+9494")]
        [TestCase(10_000, 80_000, "707d100+1d8+9292")]
        [TestCase(10_000, 100_000, "909d100+1d10+9090")]
        [TestCase(10_000, 120_000, "1111d100+1d12+8888")]
        [TestCase(20_000, 80_000, "606d100+2d4+19392")]
        [TestCase(20_000, 120_000, "1010d100+2d6+18988")]
        [TestCase(20_000, 160_000, "1414d100+2d8+18584")]
        [TestCase(20_000, 200_000, "1818d100+2d10+18180")]
        [TestCase(20_000, 240_000, "2222d100+2d12+17776")]
        [TestCase(30_000, 120_000, "909d100+1d10+29090")]
        [TestCase(30_000, 180_000, "1515d100+3d6+28482")]
        [TestCase(30_000, 240_000, "2121d100+1d20+1d3+27877")]
        [TestCase(30_000, 300_000, "2727d100+3d10+27270")]
        [TestCase(30_000, 360_000, "3333d100+3d12+26664")]
        [TestCase(40_000, 160_000, "1212d100+1d8+1d6+38786")]
        [TestCase(40_000, 240_000, "2020d100+1d12+1d10+37978")]
        [TestCase(40_000, 320_000, "2828d100+1d20+1d10+37170")]
        [TestCase(40_000, 400_000, "3636d100+4d10+36360")]
        [TestCase(40_000, 480_000, "4444d100+4d12+35552")]
        [TestCase(50_000, 200_000, "1515d100+3d6+48482")]
        [TestCase(50_000, 300_000, "2525d100+2d10+1d8+47472")]
        [TestCase(50_000, 400_000, "3535d100+1d20+1d10+1d8+46462")]
        [TestCase(50_000, 500_000, "4545d100+2d20+1d8+45452")]
        [TestCase(50_000, 600_000, "5555d100+5d12+44440")]
        [TestCase(60_000, 240_000, "1818d100+2d10+58180")]
        [TestCase(60_000, 360_000, "3030d100+1d20+1d12+56968")]
        [TestCase(60_000, 480_000, "4242d100+3d12+1d10+55754")]
        [TestCase(60_000, 600_000, "5454d100+2d20+1d10+1d8+54542")]
        [TestCase(60_000, 720_000, "6666d100+3d20+1d10+53330")]
        [TestCase(70_000, 280_000, "2121d100+1d20+1d3+67877")]
        [TestCase(70_000, 420_000, "3535d100+1d20+1d10+1d8+66462")]
        [TestCase(70_000, 560_000, "4949d100+2d20+1d12+65048")]
        [TestCase(70_000, 700_000, "6363d100+3d20+2d4+63632")]
        [TestCase(70_000, 840_000, "7777d100+4d20+1d2+62218")]
        [TestCase(90_210, 90_210, "90210")]
        public void GetRollWithPerfectDistribution(int lower, int upper, string expectedRoll)
        {
            var roll = RollHelper.GetRollWithPerfectDistribution(lower, upper);
            Assert.That(roll, Is.EqualTo(expectedRoll));
        }

        [TestCase(1, 2, 2, "1")]
        [TestCase(6, 7, 9, "1d3")]
        [TestCase(6, 8, 10, "1d3+1")]
        [TestCase(6, 10, 18, "(1d3-1)*3+1d3+3")]
        [TestCase(9, 14, 27, "1d12+1d3+3")]
        [TestCase(9, 15, 27, "1d12+1d2+4")]
        [TestCase(12, 19, 36, "(1d6-1)*3+1d3+6")]
        [TestCase(15, 22, 45, "(1d12-1)*2+1d2+6")]
        public void GetRollWithPerfectDistribution_WithBaseAmount(int baseAmount, int lower, int upper, string expectedRoll)
        {
            var roll = RollHelper.GetRollWithPerfectDistribution(baseAmount, lower, upper);
            Assert.That(roll, Is.EqualTo(expectedRoll));
        }
    }
}
